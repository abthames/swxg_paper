---
title: 'swxg: A Python Package for Fast, General Stochastic Weather Generation'
tags:
  - Python
  - swxg
  - stochastic
  - weather
  - generator
  - semiparametric
  - copula
authors:
  - name: Alexander B. Thames
  - orcid: 0000-0003-4044-2471
  - affiliation: 1
  - name: Antonia Hadjimichael
  - orcid: 0000-0001-7330-6834
  - affiliation: 1
  - name: Julianne D. Quinn
  - orcid: 0000-0001-7806-4416
  - affiliation: 2
affiliations:
  - index: 1
  - name: Department of Geosciences, The Pennsylvania State University. University Park, Pennsylvania, USA.
  - index: 2
  - name: School of Engineering and Applied Science, University of Virginia. Charlottesville, Virginia, USA.
date: 18 Aug 2025
bibliography: paper.bib
---

# Summary
As the changing global climate affects all aspects of the global water cycle [@intergovernmental_panel_on_climate_change_ipcc_climate_2023], impacts to water availability are disproportionally observed in the agricultural sector since agriculture accounts for nearly 70\% of global freshwater withdrawals and nearly 90\% of global consumptive use [@iglesias_adaptation_2015, @boretti_reassessing_2019]. Accordingly, water resource managers must plan for how sectors like agriculture will evolve in a warmer future. Typical planning analyses of climate impacts on agriculture follow a "top-down" methodology [@vano_climate_2010, @cai_impacts_2015, @deb_multi-gcms_2018, @zhao_adaptation_2022] where hydroclimatic variables like precipitation and temperature are extracted from *a priori* scenarios from downscaled global circulation models (GCMs) and then bias-corrected against local historical observations before being fed into hydrological or land-surface models whose outputs, are analyzed for climate-induced impacts. But top-down methodologies and their underlying ensembles represent the lower bound on climate uncertainty \cite{stainforth_issues_2007, lamontagne_large_2018} due to issues separating the anthropogenic signal from natural variability [@najibi_statewide_2024], over- or underestimation of the hydroclimate from coarse grid sizes [@pierce_improved_2015, @song_uncertainty_2020], and the effectively small set of analyzed "important" greenhouse gas concentration and/or socioeconomic scenarios [@pielke_distorting_2021].

Alternatively, "bottom-up" methodologies center the *deep uncertainties* [@lempert_managing_2007, @kwakkel_classifying_2010, @brown_resilience_2020] associated with decision-making for climate change impacts. To do this they make use of exploratory modeling [@bankes_exploratory_1993, @moallemi_exploratory_2020] and stochastic sampling techniques to probe not just the conditions that are most likely but also other plausible but low-likelihood conditions, thereby supporting the *a posteriori* discovery of the most consequential scenarios [@bankes_exploratory_2013, @nepomuceno-fernandez_probing_2019]. In a water resources planning context, this process generally involves informing a stochastic model with hydroclimatic parameters from a host of regionally downscaled climate projections to then create a broader ensemble of counterfactual, modeled states of the world (SOWs) that are treated as inputs for the hydrologic or land-surface models used in impact analyses [@hadjimichael_defining_2020, @hadjimichael_advancing_2020, @quinn_can_2020].

Stochastic weather generators (SWGs) are suitable exploratory modeling tools for this task as they are statistical models that can simulate realistic, arbitrarily long sequences of regionally-informed meteorological variables like precipitation and temperature [@gabriel_markov_1962, @richardson_stochastic_1981, @wilks_weather_1999, @ailliot_stochastic_2015]. Critically, SWGs must be *multivariate* and *multisite* [@van_wart_creating_2015, bureau_of_reclamation_upper_2022] to account for both the region-specific spatiotemporal correlations and nonlinearities between hydroclimatic variables [@li_new_2019]. To this end we have developed `swxg`, a general purpose Python-based package that allows users to easily and quickly synthesize regionally-consistent weather variables based on an input set of observations through the state-of-the-art methodology of the semiparametric generation of precipitation followed by the conditional, copula-based generation of temperature. 

# Design Architecture
Figure \autoref{swxgarch} 

![](swxgarch.svg)\label{swxgarch}

# Statement of Need
<!---
Agriculture drives water demand in the UCRB. Therefore, to quantify how agricultural consumptive use might respond to a changing hydroclimate, we must first explore those plausible changes to the hydroclimate. To this end we contribute a new SWG that is multivariate, multisite, copula-based, and designed explicitly for integration with large-ensemble exploratory modeling. This SWG can be used for agricultural consumptive use assessments and stochastic weather realizations more broadly. Further, as a second-order process, our SWG synthesizes both the regional length of the growing season and the growing season start date for each simulated year. By characterizing precipitation, temperature, and growing season length through a bottom-up methodology, the hazards and risks for individual parcels and crops can be adequately evaluated without presupposing the climate futures that might ignore critical, plausible hydroclimatic relationships. We then pair the output from our generator as input to a regional consumptive use model to quantify these changes to the regional hydroclimate. Impacts to the basin are quantified through the relation of the experimental changes to consumptive use to their historical averages and worst-cases. An assessment of the relative contributions of hydroclimatic parameters to consumptive use variability is also performed. By investigating these effects across the UCRB, we answer the essential questions of: How will changing precipitation and temperature affect water requirements in the UCRB, and; How will changes in water requirements be distributed across the UCRB?

#Due to unique compounding influences on water availability, the western US has been a focal area to perform these bottom-up climate impact analyses \cite{dettinger_western_2015, cook_climate_2018, overpeck_climate_2020}. Bottom-up methodologies have already been employed in the western US, and critically in the Upper Colorado River Basin (UCRB) within the State of Colorado \cite{bracken_hidden_2014, hadjimichael_defining_2020, quinn_can_2020, gold_exploring_2024} as it is the largest subbasin in the state of Colorado and is the largest consumer of water out of any subbasin \cite{state_of_colorado_colorado_2023, state_of_colorado_colorado_2025}. Agriculture accounts for $\sim$80\% of the water consumptive used in the UCRB, so water availability is principally driven by agriculture and therefore highly sensitive to climate change \cite{richter_water_2020}. While the previous bottom-up studies in the UCRB exploring changing regional water availability have done so by varying hydrologic, demand, environmental and institutional factors, these demand factors representative of hydroclimatic changes to agriculture have been accounted for only by the uniform rescaling of water demands uninformed by climate projections or spatial heterogeneities. Without a direct, systematic exploration of changes to the hydroclimate on agriculture, it is possible to underestimate or miss altogether significant environmental and water availability impacts \cite{yang_climate_2024}. For example, while increasing temperatures could benefit agricultural production through longer growing seasons, this would put increased pressure on an already stressed hydrological system through increases to evapotranspiration, heat stress, and shifts in peak streamflow supply away from peak demand, leaving more time for evaporation \cite{walsh_climate_2020, haqiqi_quantifying_2021, bolinger_climate_2023}. Further, how changes to annual precipitation and its variability will pair with increases to temperature and ultimately translate to actual agricultural water requirements is itself deeply uncertain \cite{crimmins_agriculture_2023}. It follows that to properly assess climate-influenced changes to agriculture in the UCRB we must understand the climate's effects on agriculture across the full range of plausible futures through a bottom-up methodology that allows us to quantify compounding effects on both water demand and availability.

#Multivariate, multisite SWGs that utilize copulae to account for system nonlinearities represent the state of the art for weather generation \cite{steinschneider_weatherregimebased_2019, chen_postprocessing_2022, gupta_understanding_2023, van_de_velde_future_2023, najibi_statewide_2024, zaniolo_find_2024}. However, the fitness of these contemporary multivariate, multisite SWGs for impact and vulnerability assessments largely depends on their ability to sample the relevant space sufficiently and replicate spatiotemporal correlations for historical observations or future projections. The generator constructed by \citeA{steinschneider_weatherregimebased_2019} and expanded on by \citeA{gupta_understanding_2023, gupta_exploring_2025} and \citeA{najibi_statewide_2024, najibi_statewide_2024-1} considers a process-based SWG for the Tuolumne River Basin in California where weather regimes are first simulated before the weather parameters themselves. This weather-regime inclusion is sensible for California due to its proximity to the Pacific Ocean and the subsequent impact decadal-scale climate and thermodynamic changes like ENSO impose on local precipitation and temperature \cite{steinschneider_weatherregimebased_2019}. For the broader Upper Colorado River Basin and the UCRB specifically, however, any correlation to large-scale climate variability is not very strong \cite{bolinger_attribution_2014} or fairly low frequency \cite{nowak_colorado_2012}, meaning that using this existing generator in the UCRB to prime the monthly or annual distributions of precipitation and temperature may prioritize insignificant atmospheric conditions and lead to poorer statistical fitness. Accordingly, this poorer fitness would extend to any region not strongly influenced by weather regimes. \citeA{chen_postprocessing_2022} and \citeA{van_de_velde_future_2023} construct statistical SWGs that condition temperature on precipitation in Belgium and China respectively, and while both SWGs successfully model their study areas, the former is primarily designed for forecasting and downscaling while the latter is designed for top-down applications. The statistical SWG constructed by \citeA{zaniolo_find_2024} acknowledges precipitation and temperature as critical parameters to synthesize for hydrologic scenarios but only uses them as intermediates to generate drought and control for its frequency, intensity and duration in streamflow scenarios, making this generator applicable for water availability modeling but not for characterizing agricultural water demand directly.
-->

# Acknowledgments
Acknowledgments to come!

# References
